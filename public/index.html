<!DOCTYPE html>
<html lang="en">

<head>
    <title>DaVinci CDex</title>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="lib/fhir-client-0.1.8.js"></script>
    <script src="lib/jquery-3.3.1.js"></script>
    <script src="lib/jszip.js"></script>
    <script src="lib/FileSaver.js"></script>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="lib/chosen/chosen.min.css" rel="stylesheet" />
    <script src="lib/chosen/chosen.jquery.min.js"></script>

    <!--TODO: don't use CDN-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

    <link href="css/custom.css" rel="stylesheet">
    <script src="js/config.js"></script>
</head>

<body>
    <div class="wine-row">
        <img src="images/request.png" style="height:80px; width:130px">
        <div class="wine-text-container">
            <h1></h1>
        </div>
    </div>

    <div id="task-intro-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">CDex Scenarios Description</h5>
            <p class='card-text' id='task-intro'></p>
            <a href="#" class="btn btn-primary" id="btn-task" data-toggle="tooltip" data-placement="top">
                Task Based Approach
                <span>
                    <b>Task Based Approach:</b><br>
                    A system that needs information about a patient/member and which can solicit that information using
                    the asynchronous CDEX Task based approach.<br>
                    For detailed documentation see:
                    http://build.fhir.org/ig/HL7/davinci-ecdx/task-based-approach.html<br>
                    <ul>
                        <li>
                            Example Transaction:
                            <ul>
                                <li>Data Consumer creates a Task on the Data Source’s system soliciting a patient’s knee
                                    surgery report and then polls for updates to the Task.</li>
                                <li>Data Source completes the data request and updates the Task with the requested
                                    information and the status to “completed”.</li>
                                <li>The Data Consumer fetches the completed Task and the documents referenced in it.
                                </li>
                            </ul>
                        </li>
                    </ul>
                </span>
            </a>
            <a href="#" class="btn btn-primary" id="btn-query" data-toggle="tooltip" data-placement="top">Direct Query
                <span>
                    <b>Direct Query:</b><br>
                    A system that needs information about a patient/member and which can solicit that information using
                    standard FHIR RESTful queries.<br>
                    For detailed documentation see: http://build.fhir.org/ig/HL7/davinci-ecdx/direct-query.html<br>
                    <ul>
                        <li>Example Transaction: Action: Synchronous Data Consumer executes a RESTful search the
                            Synchronous Data Source’s system<br>
                            that will return the patient’s active medication orders
                        </li>
                    </ul>
                </span>
            </a>
            <a href="#" class="btn btn-primary" id="btn-attach" data-toggle="tooltip" data-placement="top">Submit Unsolicited Attachment
                <span><b>Submit unsolicited attachment:<br></b>
                    Provider invokes the ‘$submit-attachment’ operation on the Payer’s endpoint to attach a document to
                    an existing Claim or Prior Authorization.
                    <br>The Data Consumer returns a success code For detailed documentation see:
                    http://build.fhir.org/ig/HL7/davinci-ecdx/sending-attachments.html
                    <br>Example Transaction:
                    <br>
                    <ul>
                        <li>Provider submits a visit summary for a claim they are submitting to the Payer using
                            $submit-attachment.</li>
                        <li>The Data Consumer returns a success code indicating that the $submit-attachment payload was
                            recieved.</li>
                        <li>Association of the attachment to the Claim resource.</li>
                    </ul>
                </span></a>
            <a href="#" class="btn btn-primary" id="btn-request-attach" data-toggle="tooltip"
                data-placement="top">Request Attachment
                <span><b>Requesting Attachments:<br></b>
                    Payer solicits additional information for a claim or prior authorization using the asynchronous CDEX
                    Task based approach.<br>
                    The actual data requested uses “attachments codes” or a FHIR Questionnaire. For detailed
                    documentation see:<br>
                    http://build.fhir.org/ig/HL7/davinci-ecdx/requesting-attachments-code.html and
                    http://build.fhir.org/ig/HL7/davinci-ecdx/requesting-attachments-code.html.<br>
                    <ul>
                        <li>
                            Example Transaction 1:
                            <ul>
                                <li>Payer asks for a visit summary for a Payer’s claim using Task using and attachment
                                    code</li>
                                <li>In a separate transaction the Provider submits the requested data using
                                    $submit-attachment to the Payer.</li>
                            </ul>
                        </li>
                        <li>
                            Example Transaction 2:
                            <ul>
                                <li>Payer asks for a additional data for a Payer’s Home Oxygen Therapy Claim using a
                                    FHIR Questionnaire</li>
                                <li>In a separate transaction the Provider submits the completed FHIR
                                    QuestionnaireResponse using $submit-attachment to the Payer.</li>
                            </ul>
                        </li>
                    </ul>
                </span></a>
            <a href="#" class="btn btn-primary" id="btn-submit-attach" data-toggle="tooltip" data-placement="top">Submit
                Solicited Attachments
                <span><b>Submit Solicited (Requested) Attachment:<br></b>
                    In response to a Payer’s request for attachment using an attachment code or a questionnaire,
                     the Provider collects the information and <br>
                    Provider invokes the ‘$submit-attachment’ operation on the Payer’s endpoint to attach a document or
                     QuestionnaireResponse to<br>
                    an existing Claim or Prior Authorization.<br>
                    The Data Consumer returns a success code For detailed documentation see:<br>
                    http://build.fhir.org/ig/HL7/davinci-ecdx/sending-attachments.html<br>
                    <ul>
                        <li>
                            Example Transaction 1:
                            <ul>
                                <li>In a separate transaction, Payer asks for a visit summary for a Payer’s claim using
                                    Task using and attachment code.</li>
                                <li>The Provider submits the requested data using $submit-attachment to the Payer.</li>
                                <li>Association of the attachment to the Claim resource.</li>
                            </ul>
                        </li>
                        <li>
                            Example Transaction 2:
                            <ul>
                                <li>In a separate transaction, Payer asks for a additional data for a Payer’s Home
                                    Oxygen Therapy Claim using a FHIR Questionnaire</li>
                                <li>The Provider submits the completed FHIR QuestionnaireResponse using
                                    $submit-attachment to the Payer.</li>
                                <li>Association of the attachment to the Claim resource.</li>
                            </ul>
                        </li>
                    </ul>
                </span>
            </a>
        </div>
    </div>
    <div></div>

    <div id="query-request-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">Direct Query Type</h5>
            <label for="basic-url">Query URI</label>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon3">&clinical-status=active,recurrance,remission</span>
                </div>
                <input type="text" class="form-control" id="basic-url" aria-describedby="basic-addon3">
            </div>
            <a href="#" class="btn btn-primary" id="btn-execute-query">Proceed</a>
        </div>
    </div>
    <div id="preview-communication-screen" class="screen">
        <p>
        <div class='dvt' id='resources-list'>

        </div>
        </p>
        <button type="button" class="btn btn-secondary" id="btn-back">Back</button>
    </div>
    <div id="preview-screen" class="screen">
        <table class='table'>
            <tr>
                <td colspan="5"><img src="images/glow.gif" id="spinner-preview" style="height:400px; width:500px"></td>
            </tr>
            <tbody id='preview-list'></tbody>
        </table>
        <button type="button" class="btn btn-secondary" id="btn-back-communication">Back</button>
    </div>
    <div id="communication-request-screen" class="screen">
        <h3>Patient: <span id="commRes-patient-name">[loading...]</span></h3>
        <p>
            <button type="button" class="btn btn-primary" id="btn-task-request">Create Data Request</button>
            <a href="#" class="btn btn-primary" id="btn-task-restart-commreq">Cancel</a>
        </p>
        <div>
            <p>
            <div class='dvt'>
                <table class='table'>
                    <thead>
                        <th>Data Request (Task)</th>
                        <th>Created</th>
                        <th>Workflow Type</th>
                        <th>Status</th>
                    </thead>
                    <tbody id='comm-request-list'></tbody>
                </table>
            </div>
            </p>
        </div>
        <div id='communication-request-screen-loader'>
            <p>[loading...]</p>
        </div>
    </div>
    <div id="direct-query-request-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h3>Patient: <span id="commRes-patient-name">[loading...]</span></h3>
            <select class='form-control' id='search-criteria'>
                <option>-- Select search criteria --</option>
            </select>
            <div id="subsearch" class="subsearch"></div>
            <p>
                <button type="button" class="btn btn-primary" id="btn-query-request">Direct Query Request</button>
                <a href="#" class="btn btn-primary" id="btn-query-restart">Cancel</a>
            </p>
        </div>
    </div>

    <div id="attachment-submit-screen" class="card alert-warning screen dvt">
        <div class="card-body">
            <h5><b></strong>CDEX: Provider Unsolicited Attachment Transaction</b></h5>
            <h5>Patient: <span id="commRes-patient-name">[loading...]</span></h5>
            <div>
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Tracking control number:</b><br>
                        Select a pre-existing tracking control number for this patient
                        (if the list is empty it probably means the patient does not have any pre-existing claims or
                        prior authorizations.
                        You can make up your own custom tracking control number using the checkbox below or select
                        another patient)
                    </span>
                </a>
                <select class='form-control' id='submit-searchClaim'>
                    <option>-- Select tracking control number --</option>
                </select>
                <div>
                    <input type='checkbox' id='type-claim' name='type-claim' value='typed'>
                    <label class="btninfo" for='type-claim' data-toggle="tooltip" data-placement="bottom">
                        Tracking Control Number
                        <span>
                            <b>Custom tracking control number:</b><br>
                            Check this box to submit your own custom tracking control number for a claim or prior
                            authorization
                            instead of using the control number picker
                        </span>
                    </label>
                </div>
                <input type='text' id='claimid' name='claimid' disabled="disabled" value="">
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Custom tracking control number:</b><br>
                        When the Tracking Control Number check box is selected, you can add your own custom tracking
                        control number.
                    </span>
                </a>
            </div>
            <div class="form-check form-check-inline">
                <label for="radio-claim">
                    <input type="radio" id="radio-claim" name="code" value="claim" checked="checked"
                        disabled="disabled"> Claim
                </label><br>
            </div>
            <div class="form-check form-check-inline">
                <label for="radio-auth">
                    <input type="radio" id="radio-auth" name="code" value="prior-authorization"
                        disabled="disabled">Prior Authorization
                </label><br>
            </div>
            <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                <i class="fa fa-info"></i>
                <span>
                    <b>Custom tracking control number type:</b><br>
                    When the Tracking Control Number check box is selected,
                    you can select whether your own custom tracking control number is for a claim or prior
                    authorization.
                </span>
            </a>
            <br>
            <div>
                <label for="serviceDate">Service date</label><br>
                <input type="date" id="serviceDate" name="serviceDate">
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Service date:</b><br>
                        Enter date of service or starting date of the service for the claim or prior authorization.
                        It is optional if the attachment is for a prior authorization.
                    </span>
                </a>

            </div><br>
            <div id="loincCodes">
                <label>LOINC Attachment Code</label>
            </div><br>
            <label for="select-attch" class="btn btn-success btninfo" data-toggle="tooltip" data-placement="bottom">
                Select Attachments to submit
                <span><b>Select Attachments to submit:</b><br>
                    Select the attachments to submit from your local folder,
                    The supported types of files are PDF, CCDA(xml), and FHIR(json)
                </span>
            </label>
            <input type="file" name="attachments" id="select-attch" style="visibility:hidden;">
            <div id="selected-attch" class="subsearch"></div>
            <div>
                <br>
                <input type='checkbox' id='signature' name='signature' value='signed'>
                <label for='signature' class="btninfo" data-toggle="tooltip" data-placement="bottom">
                    Signature required
                    <span><b>Signature required:</b><br>
                        Check this box to indicate that the PAYER requires a digital signature for this transaction.
                        If selected, it will trigger the Payer to verify any attachments that are FHIR resources, are a
                        signed FHIR bundle
                        (PDF and CCDA(xml) are assumed to be natively signed).
                    </span>
                </label>
                <br>
            </div>
            <p>
                <br>
                <button type="button" class="btn btn-primary" id="btn-attch-submit">
                    Submit Attachment(s)
                </button>
                <a href="#" class="btn btn-primary" id="btn-restart-attachment">Cancel</a>
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Submit unsolicited attachment(s):</b><br>
                        Click on Submit Attachment(s) button to invoke the $submit-attachment operation to submit
                        unsolicited attachments<br>
                        and the necessary information to associate them with the claim or prior authorization for
                        claims<br>
                        or prior authorization to Payer. The Payer will return an HTTP response
                    </span>
                </a>
            </p>
            <label for="name"><b>Custom payer endpoint: </b></label>
            <input type="text" id="subUnsAttchPayerEndpoint" name="customPayerEndpoint" required
                placeholder="https://api.logicahealth.org/DaVinciCDexPayer/open"><br>
        </div>
    </div>

    <div id="attachment-confirm-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">CDEX: Payer Response to Unsolicited Attachments Transaction</h5>
            <p class="card-text stayover">
                Parameter successfully created
                <span>
                    <b>Parameter:</b><br>
                    Payer Receives Body $submit-attachments operation Transaction which is a
                    Parameters resource containing One or more attachments as FHIR Resources and
                    Data elements for the association to the claim/prior authorization.
                </span>
            </p>
            <p class="card-text"><textarea id="parameter-output"></textarea></p>
            <p class="card-text stayover">
                <label id="Resource"></label>
                <span>
                    <b>Attachment as a FHIR resource.</b><br>
                    Non-FHIR attachment data is conveyed using the DocumentReference.
                    Servers SHALL support the DocumentReference resource type and SHOULD support other types.
                </span>
            </p>
            <p class="card-text"><textarea id="binary-output"></textarea></p>
            <p class="card-text stayover">
                Operation outcome
                <span>
                    <b>Status codes:<br></b>
                    When processing the operation, a server may return one of several status codes:<br>
                    200 OK: Indicates that the server has accepted the clinical attachments.<br>
                    If the attachments can not be associated with an existing claim or member, the server SHOULD return
                    an OperationOutcome to inform the Data Source that the attachments are being held for a subsequent
                    association to a claim or prior authorization.<br>
                    4xx: Indicates some error in the submission. The client SHOULD interpret a 4xx response to indicate
                    that there is no point in resubmitting the unaltered operation,<br>
                    5xx: Indicates some system error. The client SHOULD interpret a 5xx response to indicate an
                    unexpected error occurred on the part of the server, with the implication that it may be appropriate
                    to resubmit the original operation.<br>
                    The server SHOULD return an OperationOutcome with additional error information if the response code
                    is 400 or greater. For example, if the payer does not know the claim or prior authorization, the
                    OperationOutcome can alert the submitter to check whether they sent it to the wrong payer.<br>
                </span>
            </p>
            <p class="card-text"><textarea id="operation-output"></textarea></p>
            <p class="card-text stayover">
                <label id="claimCreateUpdate"></label>
                <span>
                    <b>Claim:<br></b>
                    The Payer associates the attachments to the claim or prior authorization, and processes the claim.
                    <br>
                    This is not part of CDEx. It is shown here to demonstrate one possible Payer scenario using the FHIR
                    Claim resource. <br>
                    Payer records it on their Claim resource like this…<br><br>
                    1.- Attachment data from Submit Attachment Operation–> Claim.supportingInfo.valueAttachment<br>
                    2.- Assign id for this attachment within the Claim resource --> Claim.supportingInfo.sequence
                    Claim.item.sequence matched to —> line item data from Submit Attachment Operation<br>
                    3.- Claim.item.informationSequence refers to Claim.supportingInfo.sequence (id for attachment within
                    the Claim resource from above)
                </span>
            </p>
            <p class="card-text"><textarea id="claim-output"></textarea></p>
            <p class="card-text">
                <a href="#" class="btn btn-primary" id="attch-btn-restart">OK</a>
                <a href="#" class="btn btn-primary" id="download-resources">
                    Download
                </a>
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Download resources:</b><br>
                        Click on this button download a zip file containing all the content in the Text boxes above
                    </span>
                </a>
            </p>
        </div>
    </div>

    <div id="data-request-screen" class="screen">
        <h3>Edit data request (patient: <span id="patient-name">
                <p>[loading...]</p>
            </span>)</h3>
        <div id="subscription-selection">
            <p>
                Workflow Type
                <!--<input type="checkbox" id="chk-subscription" checked="checked">-->
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                <label class="btn btn-primary active">
                    <input type="radio" name="options" id="polling" autocomplete="off" checked> Polling
                </label>
                <label class="btn btn-primary">
                    <input type="radio" name="options" id="subscription" autocomplete="off"> Subscription
                </label>
            </div>
            </p>
        </div>
        <div id="menu-request-list">
            <p>
                Request Details
            <div class='dvt'>
                <div id='selection-query-list'></div>
            </div>
            </p>
        </div>
        <!--<div><a href='#' id="btn-add">add another request</a></div>-->
        <div>
            <!--<br>-->
            <button type="button" class="btn btn-primary" id="btn-review">Review</button>
        </div>
    </div>
    <div id="review-screen" class="screen">
        <h3>Review data request (patient: <span id="review-name">
                <p>[loading...]</p>
            </span>)</h3>
        <p class="alert-warning card-text">
            <strong>Workflow:</strong> <span id="review-workflow" class="card-text"></span><br />
            <strong>Request:</strong> <span id='final-list'></span>
        </p>
        <div>
            <button type="button" class="btn btn-secondary" id="btn-edit">Edit</button>
            <button type="button" class="btn btn-secondary" id="btn-configuration">Configure endpoint</button>
            <button type="button" class="btn btn-primary" id="btn-submit">Submit</button>
        </div>
    </div>
    <div id="confirm-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">Confirmation</h5>
            <div id="request-id"></div>
            <p class="card-text">Data request (Task) successfully sent to Data Source (Provider). </p>
            <p class="card-text" id="submit-endpoint"></p>
            <p class="card-text"><textarea id="text-output"></textarea></p>
            <p class="card-text" id="submit-endpoint2"></p>
            <p class="card-text"><textarea id="text-output2"></textarea></p>
            <p class="card-text"><a href="#" class="btn btn-primary" id="btn-task-restart">OK</a></p>
        </div>
    </div>
    <div id="dq-confirm-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">Confirmation</h5>
            <p class="card-text">Direct Query request successfully sent to url: </p>
            <p class="card-text" id="dq-submit-endpoint"></p>
            <p class="card-text"><textarea id="dq-text-output"></textarea></p>
            <p class="card-text"><a href="#" class="btn btn-primary" id="dq-btn-restart">OK</a></p>
        </div>
    </div>
    <div id="config-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">Provider Endpoint Configuration</h5>
            <p class='card-text'>
            <p>
                <select class='custom-select' id='config-select'></select>
            </p>
            <p>
                <textarea id="config-text"></textarea>
            </p>
            </p>
            <a href="#" class="btn btn-primary" id="btn-config">Save configuration</a>
        </div>
    </div>
    <div id="error-screen" class="card alert-danger screen dvt">
        <div class="card-body">
            <h5 class="card-title" id='error-title'>Error</h5>
            <p class='card-text' id='error-message'></p>
        </div>
    </div>

    <div id="attachment-requested-screen" class="card alert-warning screen dvt">
        <div class="card-body">
            <h5 class="card-title">CDEX: Provider Response to a CDex Task Posted by a Payer</h5>
            <p id="task-created-header">Task created on Provider FHIR server</p>
            <div class="bg-success-custom"><p>If the Task was successfully created, The user can complete the request by clicking the “OK”
                button below and the “Submit Solicited Attachments” button on the CDex Dashboard</p></div>
            <br>
            <p class="card-text"><textarea id="req-task-output"></textarea></p>
            <p class="card-text">
                <a href="#" class="btn btn-primary" id="reqattch-btn-restart">OK</a>
                <a href="#" class="btn btn-primary" id="download-reqattch">Download</a>
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Download resources:</b><br>
                        Click on this button download a zip file containing all the content in the Text boxes above
                    </span>
                </a>
            </p>
        </div>
    </div>

    <div id="request-provider-attachments" class="card alert-info screen dvt">
        <div class="card-body">
            <h5><b></strong>CDEX: Payer Requesting Attachments or Additional Data for a Claim or Prior Authorization</b>
            </h5>
            <h5>Patient: <span id="commRes-patient-name">[loading...]</span></h5>
            <div>
                <h5><b></strong>Attachment Codes or Questionnaire</b></h5>
                <p class="text-danger">CDex Attachments are requested in Task.input using either Attachment Codes or
                    FHIR Questionnaire.</br>Select how CDex Attachments are requested in Task.input using the radio
                    buttons below</p>
                <label for="attachment-codes">
                    <input type="radio" id="attachment-codes" name="attachment" value="attachment" checked="checked">
                    Attachment Codes
                </label><br>
                <label for="questionnaire">
                    <input type="radio" id="questionnaire" name="attachment" value="questionnaire"> Questionnaire
                </label><br>
            </div>
            <div id="attachment-codes-form">
                <a class="stayover" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        <b>Select a Claim or Prior Auth:</b><br>
                        Select a pre-existing claim or prior-authorization for this patient. (if the list is empty it
                        probably means the patient does not have any pre-existing claims or prior authorizations. You
                        can create a new claim for this patient or select another patient)
                    </span>
                </a>
                <select class='form-control' id='req-searchClaim'>
                    <option>-- Select a Claim or Prior Auth --</option>
                </select>
                <div id="questionnaire-form">
                    <p class="stayover">
                        Request Questionnaire
                        <span>
                            <b>Request Questionnaire:</b><br>
                            Select from existing Questionnaires to communicate the missing data. Currently there is only
                            a single option.
                        </span>
                    </p>
                    <select class='form-control' id='req-questionnaire'>
                        <option value="http://example.org/cdex-questionnaire-example1">Adaptive Home Oxygen Therapy
                            Order Template (SDC)</option>
                    </select>
                </div>
                <div id='lineItems'>
                </div>
                <div id="incloincCodes">
                    <p class="stayover">
                        LOINC Attachment Code
                        <span>
                            <b>LOINC Attachment Code:</b><br>
                            Select the LOINC attachment code(s) to communicate the missing data. Typically, these
                            concepts represent data in document form (e.g., a PDF or CCDA). For more information about
                            LOINC attachment codes see https://loinc.org/attachments/
                        </span>
                    </p>
                </div>
                <div id="check-task-signature">
                    <p class="stayover"><br>
                        <input type='checkbox' id='task-signature' name='signature' value='signed'>
                        <label for='task-signature'>
                            Signature required
                        </label>
                        <span><b>Signature required:</b><br>
                            Check this box to indicate that the PAYER requires a digital signature for this transaction.
                            If selected, it will trigger the Payer to verify any attachments that are FHIR resources are
                            a
                            signed FHIR bundle
                            (PDF and CCDA(xml) are assumed to be natively signed).
                        </span>
                    </p>
                </div>
                <p>
                    <a class="stayover" href="#" data-toggle="tooltip" data-placement="bottom">
                        <i class="fa fa-info"></i>
                        <span>
                            <b>Create task:</b><br>
                            POST CDex Task to Provider's FHIR Server to solicit attachments.
                        </span>
                    </a><br>
                    <button type="button" class="btn btn-primary" id="btn-create-task">Create Task</button>
                    <a href="#" class="btn btn-primary" id="btn-restart-task">Cancel</a>
                </p>
                <div id="table-task-info">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col" colspan="2" class="table-warning">The Table below shows the data
                                    elements used to create the CDex Task for requesting attachments or additional data
                                    for a claim or prior authorization.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Tracking ID (Provider or Payer Assigned)</th>
                                <td id="trackingIdCol"></td>
                            </tr>
                            <tr>
                                <th>Task.code</th>
                                <td>data-request</td>
                            </tr>
                            <tr>
                                <th>Use</th>
                                <td id="useCol">Claim attachment (CLMATTCH)</td>
                            </tr>
                            <tr>
                                <th>Payer ID</th>
                                <td id="payerIdCol">Get it from app</td>
                            </tr>
                            <tr>
                                <th>Payer URL</th>
                                <td id="urlCol">Get it from app</td>
                            </tr>
                            <tr>
                                <th>Provider ID</th>
                                <td id="providerIdCol">cdex-example-practitioner (Dr. Ronald Bone)</td>
                            </tr>
                            <tr>
                                <th>Claim/PreAuth ID</th>
                                <td id="claimIdCol"></td>
                            </tr>
                            <tr>
                                <th>LOINC Attachment Code</th>
                                <td id="loincCol"></td>
                            </tr>
                            <tr>
                                <th>Due date</th>
                                <td id="dueDateCol"></td>
                            </tr>
                            <tr>
                                <th>Date of service</th>
                                <td id="serviceDateCol"></td>
                            </tr>
                            <tr>
                                <th>Member ID</th>
                                <td id="memberIdCol"></td>
                            </tr>
                            <tr>
                                <th>Patient name</th>
                                <td id="patientNameCol"></td>
                            </tr>
                            <tr>
                                <th>Patient Account No.</th>
                                <td id="patientAccCol"></td>
                            </tr>
                            <tr>
                                <th>Patient DOB</th>
                                <td id="patientDOBCol"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <label for="name"><b>Custom provider endpoint: </b></label>
        <input type="text" id="customProviderEndpoint" name="customProviderEndpoint" required
            placeholder="https://api.logicahealth.org/DaVinciCDexProvider/open">
        <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
            <i class="fa fa-info"></i>
            <span>
                <b>Custom payer endpoint:</b><br>
                A "3rd party" endpoint where the CDEX Task will be posted instead of the default RI FHIR Server.
            </span>
        </a>
    </div>

    <div id="submit-payer-attachments" class="card alert-warning screen dvt">
        <div class="card-body">
            <h5 class="card-title">CDEX: Provider Submitting Solicited Attachments - Select Task</h5>
            <h5 class="card-title">Select task below to complete the request for attachments.</h5><br>
            <div>
                <p><b>Tasks Using Attachment Codes to Request Attachments</b></p>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">Tracking control number</th>
                            <th scope="col">Request date</th>
                            <th scope="col"></th>
                            <th scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody id="tasks-list"></tbody>
                </table>
            </div>
            <br>
            <div>
                <p><b>Tasks Using Questionnaire to Request Additional Information</b></p>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">Tracking control number</th>
                            <th scope="col">Request date</th>
                            <th scope="col"></th>
                            <th scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody id="questionnaire-list"></tbody>
                </table>
            </div>
            <p></p>
            <button type="button" class="btn btn-secondary" id="btn-restart-comm-list">Back</button>
        </div>
    </div>

    <div id="attch-request-screen" class="card alert-warning screen dvt" style="display: block;">
        <h4>CDEX: Provider Collects and Submits Attachments for Coded Attachments Requests.</h4>
        <h5>Patient <span id="req-patient-name">[Loading ...]</span></h5>
        <div id="attch-request-data"></div>
        <div id="attch-request-list">
        </div>
        <p></p>
        <div class="dvt">
            <table class="table table-striped">
                <thead>
                    <th>Select</th>
                    <th>Name</th>
                    <th>Date</th>
                    <th>LOINC</th>
                    <th>Extensions</th>
                </thead>
                <tbody id="selection-list">
                </tbody>
            </table>
            <label for="name"><b>Custom payer endpoint: </b></label>
            <input type="text" id="customPayerEndpoint" name="customPayerEndpoint" required
                placeholder="https://api.logicahealth.org/DaVinciCDexPayer/open">
        </div>
        <label for="select-solicited-attch" class="btn btn-success btninfo" data-toggle="tooltip" data-placement="bottom">
            Select Attachments to submit
            <span><b>Select Attachments to submit:</b><br>
                Select the attachments to submit from your local folder,
                The supported types of files are PDF, CCDA(xml), and FHIR(json)
            </span>
        </label>
        <input type="file" name="attachments" id="select-solicited-attch" style="visibility:hidden;">
        <select data-placeholder="Lineitems..." multiple class="chosen-select" name="lineItemDd" id="lineItem_solicitedAttch">
        </select>
        <div id="selected-solicited-attch" class="subsearch"></div><br/>

        <button type="button" class="btn btn-secondary" id="btn-back-comm-list">Back</button>
        <button type="button" class="btn btn-primary" id="btn-submit-req-attch">Submit</button>
        <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
            <i class="fa fa-info"></i>
            <span>
                <b>Submit solicited attachment(s):</b><br>
                Click on this button to invoke the $submit-attachment operation to submit to the Payer.<br>
                The Payer will return an HTTP response and associate them with the claim or prior authorization<br>
            </span>
        </a>
        <input type="hidden" value="1" id="total_attch">
    </div>

    <div id="attch-questionnaire-screen" class="card alert-success screen dvt">
        <div class="card-body">
            <h5>CDEX: DTR Launched and Fetches Questionnaire</h5>
            <h5>Patient <span id="questionnaire-patient-name">[Loading ...]</span></h5>
            <p>
            <div id="questionnaireSignature"></div>
            <label class="stayover" data-toggle="tooltip" data-placement="bottom">Please complete and submit questionnaire:
                <span>
                    The Task.code “attachment-request-questionnaire” triggers Provider to Launch DTR to complete the questionnaire."
                </span>
            </label></br>
            <img src="../images/favicon.png" alt="Questionnaire">
            <p class="text-danger"><b>This will launch a simulation of DTR process before submit the requested
                    attachment</b></p>
            </p>
            <label class="stayover" data-toggle="tooltip" data-placement="bottom">Task
                <span>
                    The Provider’s local reference to Task is shared with the DTR App.
                </span>
            </label></br>
            <p class="card-text"><textarea id="requested-task-payload"></textarea></p>
            <label class="stayover" data-toggle="tooltip" data-placement="bottom">Questionnaire
                <span>
                    DTR App inspects the Task for the questionnaire URL in the Task.input and then<br>
                    fetches the Questionnaire (and any CQL rules defined within it).
                </span>
            </label></br>
            <p class="card-text"><textarea id="requested-questionnaire-payload"></textarea></p>
            <button type="button" class="btn btn-secondary" id="btn-back-task-list">Back</button>
            <button type="button" class="btn btn-primary" id="btn-submit-questionnaire-attch">Complete Questionnaire</button>
            <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                <i class="fa fa-info"></i>
                <span>
                    <b>Complete questionnaire:</b><br>
                    The DTR App uses the Questionnaire and results from any CQL execution to generate and complete a QuestionnaireResponse.
                </span>
            </a>
        </div>
    </div>

    <div id="attch-req-confirm-screen" class="card alert-info screen dvt">
        <div class="card-body">
            <h5 class="card-title">Created/Updated resources</h5>
            <p class="card-text">Parameter created</p>
            <p class="card-text"><textarea id="req-parameter-output"></textarea></p>
            <p class="card-text">Operation outcome</p>
            <p class="card-text"><textarea id="req-operation-output"></textarea></p>
            <p class="card-text" id="claimLabel">Claim updated</p>
            <p class="card-text"><textarea id="req-claim-output"></textarea></p>
            <p class="card-text">
                <a href="#" class="btn btn-primary" id="req-attch-btn-restart">OK</a>
                <a href="#" class="btn btn-primary" id="req-download-resources">Download resources</a>
            </p>
        </div>
    </div>

    <div id="questionnaire-req-confirm-screen" class="card alert-success screen dvt">
        <h5 class="card-title">CDEX: DTR Complete QuestionnaireResponse and Update Task</h5>
        <div class="card-body">
            <h5 class="card-title">Provider side operation</h5>
            <h5 class="card-title">Created/Updated resources</h5>
            <label class="stayover" data-toggle="tooltip" data-placement="bottom">Questionnaire Response
                <span>
                    The DTR App uses the Questionnaire and results from any CQL execution to generate and complete a<br>
                    QuestionnaireResponse and uploads to Providers FHIR Server.
                </span>
            </label></br>
            <p class="card-text"><textarea id="quest-resp-output"></textarea></p>
            <label class="stayover" data-toggle="tooltip" data-placement="bottom">Modified Task
                <span>
                    The DTR App updates the Task (on the Provider FHIR Server) with a local reference to the<br>
                    QuestionnaireResponse and marks it as ‘completed’
                </span>
            </label></br>
            <p class="card-text"><textarea id="upd-task-output"></textarea></p>
            <label for="name"><b>Custom payer endpoint: </b></label>
            <input type="text" id="questSubAttchPayerEndpoint" name="customPayerEndpoint" required
                placeholder="https://api.logicahealth.org/DaVinciCDexPayer/open"><br><br>
            <p class="card-text">
                <a href="#" class="btn btn-primary" id="quest-download-resources">Download resources</a>
                <a href="#" class="btn btn-primary" id="quest-btn-submit">Provider Submits Attachment</a>
                <a class="btninfo" href="#" data-toggle="tooltip" data-placement="bottom">
                    <i class="fa fa-info"></i>
                    <span>
                        The Provider “pushes” the QuestionnaireResponse directly to the Payer-defined endpoint using the $submit-attachments operation.
                    </span>
                </a>
            </p>
        </div>
    </div>

    <script src="js/patient.js"></script>
    <script src="js/claim.js"></script>
    <script src="js/app.js"></script>
</body>

</html>